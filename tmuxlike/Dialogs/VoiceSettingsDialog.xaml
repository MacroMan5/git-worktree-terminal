<Window x:Class="tmuxlike.Dialogs.VoiceSettingsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Voice Bridge Settings" Height="520" Width="480"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#1e1e1e">
    <Window.Resources>
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#ccc" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>
        <Style x:Key="FieldInput" TargetType="TextBox">
            <Setter Property="Background" Value="#3c3c3c" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#555" />
            <Setter Property="Padding" Value="6,4" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>
        <Style x:Key="FieldCombo" TargetType="ComboBox">
            <Setter Property="Background" Value="#3c3c3c" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#555" />
            <Setter Property="Padding" Value="6,4" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Margin" Value="0,0,0,8" />
        </Style>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Scrollable settings area -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,0,0,12">
            <StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="130" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Whisper Model:" Style="{StaticResource FieldLabel}" />
                    <ComboBox Grid.Row="0" Grid.Column="1" x:Name="WhisperModelInput" Style="{StaticResource FieldCombo}" IsEditable="True">
                        <ComboBoxItem Content="tiny" />
                        <ComboBoxItem Content="base" />
                        <ComboBoxItem Content="small" />
                        <ComboBoxItem Content="medium" />
                        <ComboBoxItem Content="large-v3" />
                    </ComboBox>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Language:" Style="{StaticResource FieldLabel}" />
                    <ComboBox Grid.Row="1" Grid.Column="1" x:Name="LanguageInput" Style="{StaticResource FieldCombo}" IsEditable="True">
                        <ComboBoxItem Content="fr" />
                        <ComboBoxItem Content="en" />
                        <ComboBoxItem Content="es" />
                        <ComboBoxItem Content="de" />
                        <ComboBoxItem Content="auto" />
                    </ComboBox>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Ollama Model:" Style="{StaticResource FieldLabel}" />
                    <TextBox Grid.Row="2" Grid.Column="1" x:Name="OllamaModelInput" Style="{StaticResource FieldInput}" />

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Ollama URL:" Style="{StaticResource FieldLabel}" />
                    <TextBox Grid.Row="3" Grid.Column="1" x:Name="OllamaUrlInput" Style="{StaticResource FieldInput}" />

                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Max Record (sec):" Style="{StaticResource FieldLabel}" />
                    <TextBox Grid.Row="4" Grid.Column="1" x:Name="MaxRecordInput" Style="{StaticResource FieldInput}" />

                    <TextBlock Grid.Row="5" Grid.Column="0" Text="Refine Timeout:" Style="{StaticResource FieldLabel}" />
                    <TextBox Grid.Row="5" Grid.Column="1" x:Name="RefineTimeoutInput" Style="{StaticResource FieldInput}" />

                    <TextBlock Grid.Row="6" Grid.Column="0" Text="Python Path:" Style="{StaticResource FieldLabel}" />
                    <DockPanel Grid.Row="6" Grid.Column="1" Margin="0,0,0,8">
                        <Button DockPanel.Dock="Right" Content="Browse" Click="BrowsePython_Click" Margin="4,0,0,0"
                                Background="#3c3c3c" Foreground="#ccc" BorderThickness="0" Padding="8,4" FontSize="12" />
                        <TextBox x:Name="PythonPathInput" Style="{StaticResource FieldInput}" Margin="0" />
                    </DockPanel>
                </Grid>

                <!-- Advanced settings -->
                <Expander Header="Advanced" Foreground="#ccc" Margin="0,4,0,0" IsExpanded="False">
                    <Grid Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="130" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Host:" Style="{StaticResource FieldLabel}" />
                        <TextBox Grid.Row="0" Grid.Column="1" x:Name="HostInput" Style="{StaticResource FieldInput}" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Port:" Style="{StaticResource FieldLabel}" />
                        <TextBox Grid.Row="1" Grid.Column="1" x:Name="PortInput" Style="{StaticResource FieldInput}" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Reconnect (ms):" Style="{StaticResource FieldLabel}" />
                        <TextBox Grid.Row="2" Grid.Column="1" x:Name="ReconnectDelayInput" Style="{StaticResource FieldInput}" />

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Connect Timeout:" Style="{StaticResource FieldLabel}" />
                        <TextBox Grid.Row="3" Grid.Column="1" x:Name="ConnectTimeoutInput" Style="{StaticResource FieldInput}" />
                    </Grid>
                </Expander>

                <!-- System prompt -->
                <Expander Header="System Prompt" Foreground="#ccc" Margin="0,4,0,0" IsExpanded="False">
                    <StackPanel Margin="0,8,0,0">
                        <TextBox x:Name="SystemPromptInput" Style="{StaticResource FieldInput}"
                                 AcceptsReturn="True" TextWrapping="Wrap" Height="120"
                                 VerticalScrollBarVisibility="Auto" />
                        <Button Content="Reset to Default" Click="ResetSystemPrompt_Click" HorizontalAlignment="Left"
                                Background="#3c3c3c" Foreground="#ccc" BorderThickness="0" Padding="8,4" FontSize="11" Margin="0,4,0,0" />
                    </StackPanel>
                </Expander>
            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <DockPanel Grid.Row="2" Margin="0,8,0,0">
            <Button Content="Open Config File" Click="OpenConfigFile_Click" DockPanel.Dock="Left"
                    Background="Transparent" Foreground="#569cd6" BorderThickness="0" Padding="0,4" FontSize="11"
                    Cursor="Hand" />
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Save &amp; Restart Bridge" Click="Save_Click" IsDefault="True" Width="150" Margin="0,0,8,0"
                        Background="#007acc" Foreground="White" BorderThickness="0" Padding="8,4" FontSize="12" />
                <Button Content="Cancel" Click="Cancel_Click" IsCancel="True" Width="80"
                        Background="#3c3c3c" Foreground="#ccc" BorderThickness="0" Padding="8,4" FontSize="12" />
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
